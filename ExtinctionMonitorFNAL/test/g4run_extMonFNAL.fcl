// Simulate protons on target for ExtMonFNAL
//
// Andrei Gaponenko, 2011

#include "minimalMessageService.fcl"
#include "standardProducers.fcl"
#include "standardServices.fcl"

// Give this job a name.
process_name : runExtMonFNAL

source : {
    module_type : EmptyEvent
    maxEvents : 5
}

services : {
    //message : @local::mf_production
    message : @local::default_message

    scheduler: { defaultExceptions : false }
    TFileService : { fileName : "g4hists_ExtMonFNAL.root" }
    RandomNumberGenerator : {}

    user : {
        GeometryService : { inputFile : "ExtinctionMonitorFNAL/test/geom_extMonFNAL.txt" }
        ConditionsService : { conditionsfile : "Mu2eG4/test/conditions_01.txt" }
        GlobalConstantsService : { inputFile : "Mu2eG4/test/globalConstants_01.txt" }
        SeedService       : @local::automaticSeeds
        G4Helper : { }
    }
}

physics : {
    producers : {
        generate : {
            module_type   : EventGenerator
            inputfile     : "ExtinctionMonitorFNAL/test/genconfig_extMonFNAL.txt"
        }

        g4run : {
            module_type          : G4
            generatorModuleLabel : generate
        }

        geom : { module_type : GeometryRecorder }
    }

    filters: {
        fvd1: {
            module_type: FilterVDHits
            inputModuleLabel   : "g4run"
            inputInstanceName  : "virtualdetector"
            acceptedVids       : [ 1 ]
            storeParents       : true
        }
        fvd16: {
            module_type: FilterVDHits
            inputModuleLabel   : "g4run"
            inputInstanceName  : "virtualdetector"
            acceptedVids       : [ 16 ]
            storeParents       : true
            storeExtraHits     : true
        }
        fvd35: {
            module_type: FilterVDHits
            inputModuleLabel   : "g4run"
            inputInstanceName  : "virtualdetector"
            acceptedVids       : [ 35 ]
            storeParents       : true
            storeExtraHits     : true
        }
    }

    t1  : [ generate, g4run, fvd1  ]
    t16 : [ generate, g4run, fvd16 ]
    t35 : [ generate, g4run, fvd35 ]
    gm  : [ geom ]

    eall : [ outVD1, outVD16, outVD35, fullOutput ]
    efiltered: [ outVD1, outVD16, outVD35 ]
    e16: [  outVD16 ]
    e35: [  outVD35 ]

    trigger_paths  : [gm, t16, t35]
    end_paths      : [e16, e35]
}

outputs:
{
    outVD1: {
        module_type: RootOutput
        fileName: "gvd01.root"
        SelectEvents: { SelectEvents: [t1] }
        outputCommands:   [ "keep *_fvd1_*_*", "keep *_geom_*_*" ]
    }

    outVD16: {
        module_type: RootOutput
        fileName: "gvd16.root"
        SelectEvents: { SelectEvents: [t16] }
        outputCommands:   [ "keep *_fvd16_*_*", "keep *_geom_*_*" ]
    }

    outVD35: {
        module_type: RootOutput
        fileName: "gvd35.root"
        SelectEvents: { SelectEvents: [t35] }
        outputCommands:   [ "keep *_fvd35_*_*", "keep *_geom_*_*" ]
    }

    fullOutput :
    {
        module_type   :   RootOutput
        fileName      :   "data_extMonFNAL.root"
    }
}

// Limit the amount of "Begin processing the ... record" messages
services.message.destinations.log.categories.ArtReport.reportEvery : 1
services.message.destinations.log.categories.ArtReport.limit : 1
services.message.destinations.log.categories.ArtReport.timespan : 60
