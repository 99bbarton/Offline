# recoAndKalSeedFilter.fcl
#
# FCL configuration file to run the reconstruction chain and 
# read out persistent tracks (KalSeeds) that have been filtered down
#
# A. Edmonds April 2017

#include "fcl/minimalMessageService.fcl"
#include "fcl/standardProducers.fcl"
#include "fcl/standardServices.fcl"

process_name : recoAndKalSeedFilter

source : {
  module_type : RootInput
}

services : { @table::Services.SimAndReco 

	     TFileService : { fileName : "nts.DSOWNER.trk-kalseeds.DSCONF.SEQ.root" }
}

physics : {
  filters : {
      @table::EventMixing.filters
  }

  producers : {
      @table::EventMixing.producers
      @table::Tracking.producers
  }

  analyzers : {
    genCountLogger: { module_type: GenEventCountReader }
  }

  TriggerPath : [ @sequence::EventMixing.CD3Mixers, @sequence::EventMixing.TimeMaps, @sequence::Tracking.DigiSim, @sequence::Tracking.TPRDeM ]
}

outputs : {
  KalSeedOutput : {
     module_type: RootOutput
     SelectEvents : [ TriggerPath ]
     outputCommands: [ "drop *_*_*_*", 
     		       "keep mu2e::GenEventCount_*_*_*",
		       @sequence::Tracking.Output.Digis,
		       @sequence::Tracking.Output.Hits,
		       @sequence::Tracking.Output.Tracks,
		       @sequence::Tracking.Output.MCTracks,
		       @sequence::Tracking.Output.MCDigis,
		       @sequence::Tracking.Output.MCHits,
		       "keep mu2e::StepPointMCs_*_tracker_*",
		       "keep mu2e::StepPointMCs_*_virtualdetector_*",
		       "keep mu2e::SimParticlemv_*_*_*",
		       "keep mu2e::EventWeight_*_*_*"
		     ]

     fileName : "sim.DSOWNER.trk-kalseeds.DSCONF.SEQ.art"
  }
}

physics.out : [ genCountLogger, KalSeedOutput ]
physics.end_paths : [ out ]

#include "EventMixing/fcl/epilog.fcl"